<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Finance Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary: #007bff;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --light: #f8f9fa;
            --dark: #343a40;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5;
            color: var(--dark);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        .card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }

        .btn-primary { background: var(--primary); color: white; }
        .btn-success { background: var(--success); color: white; }
        .btn-warning { background: var(--warning); color: black; }
        .btn-danger { background: var(--danger); color: white; }

        .btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }

        .tab {
            padding: 10px 20px;
            background: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tab.active {
            background: var(--primary);
            color: white;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }

        .progress-container {
            margin-top: 10px;
        }

        .progress-bar {
            height: 10px;
            background: #eee;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.3s ease;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }

        .savings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .savings-card {
            padding: 15px;
            border: 1px solid #eee;
            border-radius: 8px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            max-width: 500px;
            width: 90%;
        }

        .summary-card {
            background: linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .summary-card h3 {
            margin: 0 0 15px 0;
            color: var(--primary);
        }

        .summary-stat {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .stat-label {
            font-weight: 500;
            color: var(--dark);
        }

        .stat-value {
            font-size: 1.2em;
            font-weight: bold;
        }

        .trend-indicator {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.9em;
            margin-left: 8px;
        }

        .trend-up {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success);
        }

        .trend-down {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--danger);
        }

        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            background: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: white;
            min-width: 160px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-radius: 6px;
            z-index: 1;
        }

        .dropdown-content a {
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            color: var(--dark);
        }

        .dropdown-content a:hover {
            background-color: #f8f9fa;
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                flex: 1 1 auto;
            }
        }
    </style>
</head>
<body>
    <!-- Main Dashboard Structure -->
    <div class="container">
        <!-- Dashboard Header -->
        <div class="dashboard-header">
            <h1>Ultimate Finance Dashboard</h1>
            <div class="button-group">
                <button class="btn btn-primary" onclick="exportData()">Export Data</button>
                <button class="btn btn-success" onclick="importData()">Import Data</button>
                <button class="btn btn-warning" onclick="showSettings()">Settings</button>
            </div>
        </div>

        <!-- View Selection Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="switchView('monthly')">Monthly View</button>
            <button class="tab" onclick="switchView('yearly')">Yearly Summary</button>
            <button class="tab" onclick="switchView('savings')">Savings Tracker</button>
            <button class="tab" onclick="switchView('analytics')">Analytics</button>
        </div>

        <!-- Main Content Area -->
        <div id="main-content">
            <!-- Content will be dynamically loaded here -->
        </div>
    </div>

    <!-- Modals -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <h2>Dashboard Settings</h2>
            <!-- Settings content -->
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

<script>
// Core Data Structures
const DEFAULT_SAVINGS_CATEGORIES = {
    emergency: { name: 'Emergency Fund', target: 10000, current: 0, color: '#28a745' },
    isa: { name: 'ISA', target: 20000, current: 0, color: '#007bff' },
    property: { name: 'Property Deposit', target: 50000, current: 0, color: '#6f42c1' },
    investment: { name: 'Investment Account', target: 15000, current: 0, color: '#fd7e14' },
    general: { name: 'General Savings', target: 5000, current: 0, color: '#20c997' },
    holiday: { name: 'Holiday Fund', target: 3000, current: 0, color: '#e83e8c' }
};

let dashboardData = {
    currentView: 'monthly',
    currentMonth: new Date(),
    monthlyData: {},
    savings: DEFAULT_SAVINGS_CATEGORIES,
    settings: {
        currency: 'Â£',
        monthlyIncomeTarget: 0,
        monthlySavingsTarget: 0,
        yearlyGoals: {}
    }
};

// Initialize Dashboard
function initializeDashboard() {
    loadSavedData();
    createMonthlyData();
    setupEventListeners();
    switchView('monthly');
    updateAllDisplays();
}

// Data Management
function loadSavedData() {
    const saved = localStorage.getItem('ultimateDashboardData');
    if (saved) {
        dashboardData = { ...dashboardData, ...JSON.parse(saved) };
    }
}

function saveData() {
    localStorage.setItem('ultimateDashboardData', JSON.stringify(dashboardData));
    showNotification('Data saved successfully', 'success');
}

function createMonthlyData() {
    // Create data structure for the last 24 months
    for (let i = 0; i < 24; i++) {
        const date = new Date();
        date.setMonth(date.getMonth() - i);
        const monthKey = `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}`;
        
        if (!dashboardData.monthlyData[monthKey]) {
            dashboardData.monthlyData[monthKey] = {
                income: 0,
                expenses: [],
                savings: Object.keys(DEFAULT_SAVINGS_CATEGORIES).reduce((acc, key) => {
                    acc[key] = 0;
                    return acc;
                }, {}),
                notes: ''
            };
        }
    }
}

// View Management
function switchView(view) {
    dashboardData.currentView = view;
    const tabs = document.querySelectorAll('.tab');
    tabs.forEach(tab => tab.classList.remove('active'));
    document.querySelector(`[onclick="switchView('${view}')"]`).classList.add('active');

    const mainContent = document.getElementById('main-content');
    mainContent.innerHTML = ''; // Clear current content

    switch (view) {
        case 'monthly':
            renderMonthlyView();
            break;
        case 'yearly':
            renderYearlyView();
            break;
        case 'savings':
            renderSavingsView();
            break;
        case 'analytics':
            renderAnalyticsView();
            break;
    }
}

// Monthly View Renderer
function renderMonthlyView() {
    const currentMonthKey = getCurrentMonthKey();
    const monthData = dashboardData.monthlyData[currentMonthKey];
    
    const content = `
        <div class="grid">
            <!-- Income Section -->
            <div class="card">
                <h2>Monthly Income</h2>
                <div class="input-group">
                    <input type="number" 
                           id="monthly-income" 
                           value="${monthData.income}"
                           onchange="updateMonthlyIncome(this.value)"
                           placeholder="Enter monthly income">
                </div>
            </div>

            <!-- Expenses Section -->
            <div class="card">
                <h2>Expenses</h2>
                <div class="input-group">
                    <input type="text" id="expense-name" placeholder="Expense name">
                    <input type="number" id="expense-amount" placeholder="Amount">
                    <select id="expense-category">
                        <option value="essential">Essential</option>
                        <option value="discretionary">Discretionary</option>
                        <option value="bills">Bills</option>
                        <option value="other">Other</option>
                    </select>
                    <button class="btn btn-primary" onclick="addExpense()">Add Expense</button>
                </div>
                <div id="expenses-list" class="expenses-list">
                    ${renderExpensesList(monthData.expenses)}
                </div>
            </div>

            <!-- Monthly Summary -->
            <div class="card">
                <h2>Monthly Summary</h2>
                <div class="summary-stats">
                    <div class="summary-stat">
                        <span class="stat-label">Total Income:</span>
                        <span class="stat-value">${formatCurrency(monthData.income)}</span>
                    </div>
                    <div class="summary-stat">
                        <span class="stat-label">Total Expenses:</span>
                        <span class="stat-value">${formatCurrency(calculateTotalExpenses(monthData.expenses))}</span>
                    </div>
                    <div class="summary-stat">
                        <span class="stat-label">Remaining:</span>
                        <span class="stat-value">${formatCurrency(calculateRemaining(monthData))}</span>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="monthly-expenses-chart"></canvas>
                </div>
            </div>
        </div>
    `;

    document.getElementById('main-content').innerHTML = content;
    renderMonthlyCharts(monthData);
}

// Utility Functions
function getCurrentMonthKey() {
    const date = dashboardData.currentMonth;
    return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}`;
}

function formatCurrency(amount) {
    return `${dashboardData.settings.currency}${parseFloat(amount).toLocaleString('en-UK', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
    })}`;
}

function calculateTotalExpenses(expenses) {
    return expenses.reduce((sum, expense) => sum + expense.amount, 0);
}

function calculateRemaining(monthData) {
    return monthData.income - calculateTotalExpenses(monthData.expenses);
}

function showNotification(message, type = 'info') {
    const notification = document.getElementById('notification');
    notification.textContent = message;
    notification.className = `notification ${type}`;
    notification.style.display = 'block';
    
    setTimeout(() => {
        notification.style.display = 'none';
    }, 3000);
}

// Event Listeners
function setupEventListeners() {
    // Add keyboard shortcuts
    document.addEventListener('keydown', (e) => {
        if (e.ctrlKey && e.key === 's') {
            e.preventDefault();
            saveData();
        }
    });

    // Add window unload warning
    window.addEventListener('beforeunload', (e) => {
        saveData();
    });
}

// Initialize the dashboard when the page loads
document.addEventListener('DOMContentLoaded', initializeDashboard);
</script>
    <script>
// Savings View Functions
function renderSavingsView() {
    const content = `
        <div class="savings-grid">
            ${Object.entries(dashboardData.savings).map(([key, data]) => `
                <div class="card savings-card">
                    <h3>${data.name}</h3>
                    <div class="summary-stat">
                        <span class="stat-label">Target:</span>
                        <span class="stat-value">${formatCurrency(data.target)}</span>
                    </div>
                    <div class="summary-stat">
                        <span class="stat-label">Current:</span>
                        <span class="stat-value">${formatCurrency(data.current)}</span>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${(data.current / data.target * 100)}%; background-color: ${data.color}"></div>
                        </div>
                        <p>${((data.current / data.target) * 100).toFixed(1)}% of target</p>
                    </div>
                    <div class="input-group">
                        <input type="number" id="savings-input-${key}" placeholder="Add amount">
                        <button class="btn btn-primary" onclick="addToSavings('${key}')">Add</button>
                        <button class="btn btn-warning" onclick="updateSavingsGoal('${key}')">Update Goal</button>
                    </div>
                </div>
            `).join('')}
        </div>
        <div class="card">
            <h2>Savings Overview</h2>
            <div class="chart-container">
                <canvas id="savings-overview-chart"></canvas>
            </div>
        </div>
    `;

    document.getElementById('main-content').innerHTML = content;
    renderSavingsCharts();
}

// Yearly Summary Functions
function renderYearlyView() {
    const yearlyData = calculateYearlyData();
    
    const content = `
        <div class="grid">
            <div class="card">
                <h2>Yearly Overview</h2>
                <div class="summary-stat">
                    <span class="stat-label">Total Income:</span>
                    <span class="stat-value">${formatCurrency(yearlyData.totalIncome)}</span>
                </div>
                <div class="summary-stat">
                    <span class="stat-label">Total Expenses:</span>
                    <span class="stat-value">${formatCurrency(yearlyData.totalExpenses)}</span>
                </div>
                <div class="summary-stat">
                    <span class="stat-label">Total Savings:</span>
                    <span class="stat-value">${formatCurrency(yearlyData.totalSavings)}</span>
                </div>
            </div>
            
            <div class="card">
                <h2>Monthly Trends</h2>
                <div class="chart-container">
                    <canvas id="yearly-trends-chart"></canvas>
                </div>
            </div>

            <div class="card">
                <h2>Expense Categories</h2>
                <div class="chart-container">
                    <canvas id="yearly-categories-chart"></canvas>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>Monthly Breakdown</h2>
            <div class="table-container">
                ${renderYearlyTable(yearlyData)}
            </div>
        </div>
    `;

    document.getElementById('main-content').innerHTML = content;
    renderYearlyCharts(yearlyData);
}

function calculateYearlyData() {
    const currentYear = dashboardData.currentMonth.getFullYear();
    const yearData = {
        totalIncome: 0,
        totalExpenses: 0,
        totalSavings: 0,
        monthlyData: {},
        expenseCategories: {},
        savingsProgress: {}
    };

    // Process each month
    Object.entries(dashboardData.monthlyData).forEach(([monthKey, data]) => {
        if (monthKey.startsWith(currentYear)) {
            yearData.totalIncome += data.income;
            const monthExpenses = calculateTotalExpenses(data.expenses);
            yearData.totalExpenses += monthExpenses;
            
            // Process expense categories
            data.expenses.forEach(expense => {
                yearData.expenseCategories[expense.category] = 
                    (yearData.expenseCategories[expense.category] || 0) + expense.amount;
            });

            // Process savings
            Object.entries(data.savings).forEach(([category, amount]) => {
                yearData.savingsProgress[category] = 
                    (yearData.savingsProgress[category] || 0) + amount;
                yearData.totalSavings += amount;
            });

            // Store monthly summary
            yearData.monthlyData[monthKey] = {
                income: data.income,
                expenses: monthExpenses,
                savings: Object.values(data.savings).reduce((a, b) => a + b, 0)
            };
        }
    });

    return yearData;
}

// Analytics Functions
function renderAnalyticsView() {
    const analyticsData = calculateAnalytics();
    
    const content = `
        <div class="grid">
            <div class="card">
                <h2>Financial Health Score</h2>
                <div class="chart-container">
                    <canvas id="health-score-chart"></canvas>
                </div>
                ${renderHealthIndicators(analyticsData.healthScores)}
            </div>

            <div class="card">
                <h2>Spending Patterns</h2>
                <div class="chart-container">
                    <canvas id="spending-patterns-chart"></canvas>
                </div>
            </div>

            <div class="card">
                <h2>Savings Progress</h2>
                <div class="chart-container">
                    <canvas id="savings-progress-chart"></canvas>
                </div>
            </div>

            <div class="card">
                <h2>Financial Insights</h2>
                ${renderFinancialInsights(analyticsData)}
            </div>
        </div>
    `;

    document.getElementById('main-content').innerHTML = content;
    renderAnalyticsCharts(analyticsData);
}

function calculateAnalytics() {
    const analytics = {
        healthScores: calculateHealthScores(),
        spendingPatterns: analyzeSpendingPatterns(),
        savingsProgress: analyzeSavingsProgress(),
        insights: generateInsights()
    };

    return analytics;
}

// Chart Rendering Functions
function renderMonthlyCharts(monthData) {
    const ctx = document.getElementById('monthly-expenses-chart').getContext('2d');
    
    new Chart(ctx, {
        type: 'pie',
        data: {
            labels: monthData.expenses.map(e => e.name),
            datasets: [{
                data: monthData.expenses.map(e => e.amount),
                backgroundColor: [
                    '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF',
                    '#FF9F40', '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0'
                ]
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'right'
                },
                title: {
                    display: true,
                    text: 'Monthly Expenses Breakdown'
                }
            }
        }
    });
}

// Export/Import Functions
function exportData() {
    const dataStr = JSON.stringify(dashboardData, null, 2);
    const dataBlob = new Blob([dataStr], { type: 'application/json' });
    const url = URL.createObjectURL(dataBlob);
    
    const a = document.createElement('a');
    a.href = url;
    a.download = `finance-dashboard-${getCurrentMonthKey()}.json`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    
    showNotification('Data exported successfully', 'success');
}

function importData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'application/json';
    
    input.onchange = e => {
        const file = e.target.files[0];
        const reader = new FileReader();
        
        reader.onload = event => {
            try {
                const importedData = JSON.parse(event.target.result);
                dashboardData = { ...dashboardData, ...importedData };
                saveData();
                switchView(dashboardData.currentView);
                showNotification('Data imported successfully', 'success');
            } catch (error) {
                showNotification('Error importing data', 'error');
            }
        };
        
        reader.readAsText(file);
    };
    
    input.click();
}

// Initialize charts when the page loads
document.addEventListener('DOMContentLoaded', () => {
    // Register Chart.js plugins and defaults here if needed
    Chart.defaults.font.family = "'Arial', sans-serif";
    Chart.defaults.responsive = true;
});
</script>

    <script>
// Helper Functions
function renderExpensesList(expenses) {
    if (!expenses || expenses.length === 0) {
        return '<p>No expenses recorded</p>';
    }

    return expenses.map((expense, index) => `
        <div class="expense-item">
            <span>${expense.name}</span>
            <span>${formatCurrency(expense.amount)}</span>
            <span>${expense.category}</span>
            <button class="btn btn-danger" onclick="removeExpense(${index})">Remove</button>
        </div>
    `).join('');
}

function renderYearlyTable(yearlyData) {
    return `
        <table>
            <thead>
                <tr>
                    <th>Month</th>
                    <th>Income</th>
                    <th>Expenses</th>
                    <th>Savings</th>
                    <th>Remaining</th>
                </tr>
            </thead>
            <tbody>
                ${Object.entries(yearlyData.monthlyData).map(([month, data]) => `
                    <tr>
                        <td>${formatMonth(month)}</td>
                        <td>${formatCurrency(data.income)}</td>
                        <td>${formatCurrency(data.expenses)}</td>
                        <td>${formatCurrency(data.savings)}</td>
                        <td>${formatCurrency(data.income - data.expenses - data.savings)}</td>
                    </tr>
                `).join('')}
            </tbody>
        </table>
    `;
}

function renderSavingsCharts() {
    const ctx = document.getElementById('savings-overview-chart').getContext('2d');
    
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: Object.values(dashboardData.savings).map(s => s.name),
            datasets: [{
                label: 'Current Amount',
                data: Object.values(dashboardData.savings).map(s => s.current),
                backgroundColor: Object.values(dashboardData.savings).map(s => s.color),
            }, {
                label: 'Target',
                data: Object.values(dashboardData.savings).map(s => s.target),
                type: 'line',
                borderColor: '#000',
                fill: false
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}

function showSettings() {
    const modal = document.getElementById('settings-modal');
    modal.style.display = 'flex';
    modal.innerHTML = `
        <div class="modal-content">
            <h2>Settings</h2>
            <div class="input-group">
                <label>Currency</label>
                <input type="text" id="currency-setting" value="${dashboardData.settings.currency}">
            </div>
            <div class="input-group">
                <label>Monthly Income Target</label>
                <input type="number" id="income-target-setting" value="${dashboardData.settings.monthlyIncomeTarget}">
            </div>
            <div class="input-group">
                <label>Monthly Savings Target</label>
                <input type="number" id="savings-target-setting" value="${dashboardData.settings.monthlySavingsTarget}">
            </div>
            <div class="button-group">
                <button class="btn btn-primary" onclick="saveSettings()">Save</button>
                <button class="btn btn-danger" onclick="closeSettings()">Cancel</button>
            </div>
        </div>
    `;
}

function calculateHealthScores() {
    const scores = {
        savingsRate: 0,
        expenseRatio: 0,
        emergencyFund: 0,
        overallHealth: 0
    };

    const yearlyData = calculateYearlyData();
    
    // Calculate savings rate
    scores.savingsRate = (yearlyData.totalSavings / yearlyData.totalIncome) * 100;
    
    // Calculate expense ratio
    scores.expenseRatio = (yearlyData.totalExpenses / yearlyData.totalIncome) * 100;
    
    // Calculate emergency fund status
    const emergencyTarget = dashboardData.savings.emergency.target;
    const emergencyCurrent = dashboardData.savings.emergency.current;
    scores.emergencyFund = (emergencyCurrent / emergencyTarget) * 100;
    
    // Calculate overall health (weighted average)
    scores.overallHealth = (
        (scores.savingsRate * 0.4) +
        ((100 - scores.expenseRatio) * 0.3) +
        (scores.emergencyFund * 0.3)
    );

    return scores;
}

function addToSavings(category) {
    const amount = parseFloat(document.getElementById(`savings-input-${category}`).value);
    if (amount > 0) {
        dashboardData.savings[category].current += amount;
        
        // Add to monthly tracking
        const currentMonthKey = getCurrentMonthKey();
        if (!dashboardData.monthlyData[currentMonthKey].savings[category]) {
            dashboardData.monthlyData[currentMonthKey].savings[category] = 0;
        }
        dashboardData.monthlyData[currentMonthKey].savings[category] += amount;
        
        saveData();
        renderSavingsView();
        showNotification(`Added ${formatCurrency(amount)} to ${dashboardData.savings[category].name}`, 'success');
    }
}

function updateSavingsGoal(category) {
    const newTarget = prompt(`Enter new target for ${dashboardData.savings[category].name}:`, dashboardData.savings[category].target);
    if (newTarget && !isNaN(newTarget)) {
        dashboardData.savings[category].target = parseFloat(newTarget);
        saveData();
        renderSavingsView();
        showNotification(`Updated target for ${dashboardData.savings[category].name}`, 'success');
    }
}

function formatMonth(monthKey) {
    const [year, month] = monthKey.split('-');
    const date = new Date(year, month - 1);
    return date.toLocaleDateString('en-UK', { month: 'long', year: 'numeric' });
}

function analyzeSpendingPatterns() {
    // Implement spending pattern analysis
    return {};
}

function analyzeSavingsProgress() {
    // Implement savings progress analysis
    return {};
}

function generateInsights() {
    // Implement insights generation
    return [];
}

function renderHealthIndicators(healthScores) {
    return `
        <div class="health-indicators">
            <div class="indicator">
                <h3>Savings Rate</h3>
                <p>${healthScores.savingsRate.toFixed(1)}%</p>
            </div>
            <div class="indicator">
                <h3>Expense Ratio</h3>
                <p>${healthScores.expenseRatio.toFixed(1)}%</p>
            </div>
            <div class="indicator">
                <h3>Emergency Fund</h3>
                <p>${healthScores.emergencyFund.toFixed(1)}%</p>
            </div>
            <div class="indicator">
                <h3>Overall Health</h3>
                <p>${healthScores.overallHealth.toFixed(1)}%</p>
            </div>
        </div>
    `;
}

function renderFinancialInsights(analyticsData) {
    return `
        <div class="insights-container">
            <h3>Key Insights</h3>
            <ul>
                <li>Your savings rate is ${analyticsData.healthScores.savingsRate.toFixed(1)}%</li>
                <li>Your expense ratio is ${analyticsData.healthScores.expenseRatio.toFixed(1)}%</li>
                <li>Your emergency fund is ${analyticsData.healthScores.emergencyFund.toFixed(1)}% funded</li>
            </ul>
        </div>
    `;
}
</script>
</body>
</html>
